{"version":3,"file":"no-dropping-i.js","names":["_textlintRuleHelper","require","_kuromojin","isMasuTargetWord","token","pos","pos_detail_1","basic_form","isMasuWord","isTeruTargetWord","isTeruWord","isTenaiTargetWord","isTenaiWord","conjugated_type","module","exports","context","helper","RuleHelper","Syntax","report","getSource","RuleError","Str","node","isChildNode","Link","Image","BlockQuote","Emphasis","text","tokenize","then","tokens","forEach","index","current","prev","isMasuPattern","isTeruPattern","isTenaiPattern","word_position"],"sources":["../src/no-dropping-i.js"],"sourcesContent":["// LICENSE : MIT\n\"use strict\";\nimport { RuleHelper } from \"textlint-rule-helper\";\nimport { tokenize } from \"kuromojin\";\n\nfunction isMasuTargetWord(token) {\n    return token.pos === \"助詞\" && token.pos_detail_1 === \"接続助詞\" && (token.basic_form === \"て\" || token.basic_form === \"で\");\n}\n\nfunction isMasuWord(token) {\n    return token.pos === \"助動詞\" && token.pos_detail_1 === \"*\" && token.basic_form === \"ます\";\n}\n\nfunction isTeruTargetWord(token) {\n    return token.pos === \"動詞\" && token.pos_detail_1 === \"自立\";\n}\n\nfunction isTeruWord(token) {\n    return token.pos === \"動詞\" && token.pos_detail_1 === \"非自立\" && (token.basic_form === \"てる\" || token.basic_form === \"でる\");\n}\n\nfunction isTenaiTargetWord(token) {\n    return token.pos === \"動詞\" && token.pos_detail_1 === \"非自立\" && (token.basic_form === \"て\" || token.basic_form === \"で\");\n}\n\nfunction isTenaiWord(token) {\n    return token.pos === \"助動詞\" && token.conjugated_type === \"特殊・ナイ\" && token.basic_form === \"ない\";\n}\n\nmodule.exports = function(context) {\n    const helper = new RuleHelper(context);\n    const { Syntax, report, getSource, RuleError } = context;\n    return {\n        [Syntax.Str](node) {\n            if (helper.isChildNode(node, [Syntax.Link, Syntax.Image, Syntax.BlockQuote, Syntax.Emphasis])) {\n                return;\n            }\n            const text = getSource(node);\n            return tokenize(text).then(tokens => {\n                tokens.forEach((token, index) => {\n                    const current = token;\n                    const prev = tokens[index - 1];\n\n                    if (!prev || !current) {\n                        return;\n                    }\n\n                    const isMasuPattern = isMasuTargetWord(prev) && isMasuWord(current);\n                    const isTeruPattern = isTeruTargetWord(prev) && isTeruWord(current);\n                    const isTenaiPattern = isTenaiTargetWord(prev) && isTenaiWord(current);\n\n                    if (isMasuPattern || isTeruPattern || isTenaiPattern) {\n                        report(\n                            node,\n                            new RuleError(\"い抜き言葉を使用しています。\", {\n                                index: current.word_position - 1\n                            })\n                        );\n                    }\n                });\n            });\n        }\n    };\n};\n"],"mappings":"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","ignoreList":[]}